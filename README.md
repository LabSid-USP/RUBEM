   <!-- PROJECT LOGO -->
<br />
<p align="center">
  <h1 align="center">RUBEM</h1>
  <h2 align="center">Rainfall rUnoff Balance Enhanced Model</h2>

  <p align="center">
    RUBEM is a distributed hydrological model to calculate monthly flows with changes in land use over time.
    <br />
    <a href="https://github.com/LabSid-USP/RUBEM"><strong>Explore the docs »</strong></a>
    <br />
    <br />
    <a href="https://github.com/LabSid-USP/RUBEM">View Demo</a>
    ·
    <a href="https://github.com/LabSid-USP/RUBEM/issues">Report Bug</a>
    ·
    <a href="https://github.com/LabSid-USP/RUBEM/issues">Request Feature</a>
  </p>
</p>



<!-- TABLE OF CONTENTS -->
<details open="open">
  <summary><h2 style="display: inline-block">Table of Contents</h2></summary>
  <ol>
    <li>
      <a href="#about-the-project">About The Project</a>
      <ul>
        <li><a href="#main-features">Main features</a></li>
        <li><a href="#advantages">Advantages</a></li>
        <li><a href="#citation">Citation</a></li>
      </ul>
    </li>
    <li>
      <a href="#getting-started">Getting Started</a>
      <ul>
        <li><a href="#prerequisites">Prerequisites</a></li>
        <li><a href="#installation">Installation</a></li>
        <li><a href="#packaging">Packaging</a></li>
      </ul>
    </li>
    <li><a href="#usage">Usage</a></li>
    <li><a href="#roadmap">Roadmap</a></li>
    <li><a href="#contributing">Contributing</a></li>
    <li><a href="#license">License</a></li>
    <li><a href="#contact">Contact</a></li>
    <li><a href="#acknowledgements">Acknowledgements</a></li>
  </ol>
</details>


<!-- ABOUT THE PROJECT -->
## About The Project

The Rainfall rUnoff Balance Enhanced Model (RUBEM) is a hydrological model for transforming precipitation into surface and subsurface runoff. The model is based on equations that represent the physical processes of the hydrological cycle, with spatial distribution defined by pixel, in distinct vegetated and non-vegetated covers, and has the flexibility to study a wide range of applications, including impacts of changes in climate and land use, has flexible spatial resolution, the inputs are raster-type matrix files obtained from remote sensing data and operates with a reduced number of parameters arranged in a configuration file that facilitates its modification throughout the area.

The model was developed based on classical concepts of hydrological processes and equations based mainly on SPHY (TERINK et al., 2015), WEAP (YATES et al., 2005), and WetSpass-M (ABDOLLAHI et al. , 2017). 

### Main features

* distributed monthly step model;

* hydrological process based on soil water balance in each pixel, and total flow calculated after the composition of the resulting accumulated flow, according to the flow direction of the drainage network established by the Digital Elevation Model (DEM);

* soil layer with two zones: root and saturated;

* evapotranspiration and interception process based on vegetation indices Leaf Area Index (LAI), Fraction of Photosynthetically Active Radiation (FPAR) and Normalized Difference Vegetation Index (NDVI); and

* sub-pixel level coverage classification, represented by four fractions representing percentage of total pixel area covered exclusively by: vegetated area, bare ground area, water area, and impermeable area.

### Advantages

* adopts a spatial scale representative of the catchment area and its respective water storage capacities;

* features flexible spatial resolution that allows the use of images generated by multiple remote sensors;

* a time scale appropriate to the time interval for the occurrence of physical processes that occur in the basins;

* considers the variability of the variables of the hydrological cycle over the period of analysis, especially in terms of land use and occupation;

* presents a comprehensive formulation in order to enable user interaction and allow maximum analysis capacity;

* it is open source for future changes that allows constant updating and improvements;

* is able to represent the conditions of hydrographic basins in Brazil, in their different dimensions and characteristics; and

* it is useful as an analysis tool for decision making in water resources management and planning, especially in applications involving future changes in land use and occupation and in climate.

The RUBEM presents a robust formulation, suitable to represent the uncertainties involved in the physical and hydrological aspects that change over time, and flexible to analyze basins of different spatial scales, including impacts of changes in climate and land use.

The model was named in a posthumous tribute to Professor Rubem La Laina Porto, dean of the [Department of Hydraulic and Environmental Engineering](http://www.pha.poli.usp.br/), of the [Escola Politécnica of the University of São Paulo](https://www.poli.usp.br/), who dedicated his professional life to the study, development and practices in hydrological sciences, contributing to the improvement of the state of art and training of students and professionals working in the area.

### Citation

If you use this model in your research, please cite:

	@article{??2021,
		author = {?? and ?? and ?? and ??},
		title = {??},
		journal = {??},
		year = {2021}
	}

<!-- GETTING STARTED -->
## Getting Started

To get a local copy up and running follow these simple steps.

### Prerequisites

This is an example of how to list things you need to use the software and how to install them.

* From Miniconda base envionment create a new conda envionment
   ```sh
   conda create --name rubem python=3.7
   ```
 * Activate the new environment

    Windows

     ```powershell
     conda activate rubem
     ```
    
    Linux, macOS
   
     ```sh
     source activate rubem
     ```
  
  * Install GDAL conda package
 
     ```sh
     conda install -c conda-forge gdal 
     ```
 
 * Install PCRaster conda package
 
   ```sh
   conda install -c conda-forge pcraster 
   ```

### Installation

Clone the repo
   ```sh
   git clone https://github.com/LabSid-USP/RUBEM.git
   ```
   
### Packaging

1. Clone the repo
   ```sh
   git clone https://github.com/LabSid-USP/RUBEM.git
   ```
2. Install PyInstaller conda package
   ```sh
    conda install -c conda-forge pyinstaller 
   ```   
3. Bundle this application and all its dependencies into a single package 
   ```sh
    pyinstaller -–onefile rubem.py
   ```
   
<!-- USAGE EXAMPLES -->
## Usage

 * Typical usage example
   ```sh
   python rubem.py --configfile config.ini
   ```
 * Help usage example
   ```sh
   python rubem.py -h
   ```   

_For more examples, please refer to the [Documentation](https://example.com)_

<!-- ROADMAP -->
## Roadmap

See the [open issues](https://github.com/LabSid-USP/RUBEM/issues) for a list of proposed features (and known issues).


<!-- CONTRIBUTING -->
## Contributing

Contributions are what make the open source community such an amazing place to be learn, inspire, and create. Any contributions you make are **greatly appreciated**.

1. Fork the Project
2. Create your Feature Branch (`git checkout -b feature/AmazingFeature`)
3. Commit your Changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the Branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

<!-- LICENSE -->
## License

Distributed under the GPLv3 License. See `LICENSE` for more information.

<!-- CONTACT -->
## Contact

Project Link: [https://github.com/LabSid-USP/RUBEM](https://github.com/LabSid-USP/RUBEM)

<!-- ACKNOWLEDGEMENTS -->
## Acknowledgements

* [Laboratório de Sistemas de Suporte a Decisões Aplicados à Engenharia Ambiental e de Recursos Hídricos](http://labsid.eng.br/Contato.aspx)
* [Departamento de Engenharia Hidráulica e Ambiental da Escola Politécnica da Universidade de São Paulo](http://www.pha.poli.usp.br/)
* [Fundo Patrimonial Amigos da Poli](https://www.amigosdapoli.com.br/)
